---
layout: post
title: 'JavaScript: alternative version of shared secrets'
tags:
- General
status: draft
type: post
published: false
meta:
  _edit_last: '1'
---
In his <a href="http://video.yahoo.com/watch/111585/1027823">advanced JavaScript lectures</a>, Douglas Crockford presents a technique for "shared secrets". The idea is to share an object between two power constructor functions. Here is an example from <a href="http://yuiblog.com/assets/crockford/advancedjavascript.zip">his slides</a>:

<pre><tt><span class="keyword">function</span><span class="normal"> </span><span class="function">gizmo</span><span class="symbol">(</span><span class="normal">id</span><span class="symbol">,</span><span class="normal"> secret</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">    secret </span><span class="symbol">=</span><span class="normal"> secret </span><span class="symbol">||</span><span class="normal"> </span><span class="cbracket">{}</span><span class="symbol">;</span>
<span class="normal">    secret</span><span class="symbol">.</span><span class="normal">id </span><span class="symbol">=</span><span class="normal"> id</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">return</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">        toString</span><span class="symbol">:</span><span class="normal"> </span><span class="keyword">function</span><span class="normal"> </span><span class="symbol">()</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">            </span><span class="keyword">return</span><span class="normal"> </span><span class="string">"gizmo "</span><span class="normal"> </span><span class="symbol">+</span><span class="normal"> secret</span><span class="symbol">.</span><span class="normal">id</span><span class="symbol">;</span>
<span class="normal">        </span><span class="cbracket">}</span>
<span class="normal">    </span><span class="cbracket">}</span><span class="symbol">;</span>
<span class="cbracket">}</span>

<span class="keyword">function</span><span class="normal"> </span><span class="function">hoozit</span><span class="symbol">(</span><span class="normal">id</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">    </span><span class="keyword">var</span><span class="normal"> secret </span><span class="symbol">=</span><span class="normal"> </span><span class="cbracket">{}</span><span class="symbol">,</span><span class="normal">    </span><span class="regexp">/*final*/</span>
<span class="normal">        that </span><span class="symbol">=</span><span class="normal"> </span><span class="function">gizmo</span><span class="symbol">(</span><span class="normal">id</span><span class="symbol">,</span><span class="normal"> secret</span><span class="symbol">);</span>
<span class="normal">    that</span><span class="symbol">.</span><span class="normal">test </span><span class="symbol">=</span><span class="normal"> </span><span class="keyword">function</span><span class="normal"> </span><span class="symbol">(</span><span class="normal">testid</span><span class="symbol">)</span><span class="normal"> </span><span class="cbracket">{</span>
<span class="normal">        </span><span class="keyword">return</span><span class="normal"> testid </span><span class="symbol">===</span><span class="normal"> secret</span><span class="symbol">.</span><span class="normal">id</span><span class="symbol">;</span>
<span class="normal">    </span><span class="cbracket">}</span><span class="symbol">;</span>
<span class="normal">    </span><span class="keyword">return</span><span class="normal"> that</span><span class="symbol">;</span>
<span class="cbracket">}</span>
</tt></pre>

 
